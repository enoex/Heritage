// Generated by CoffeeScript 1.4.0
(function() {
  var __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  define(['components/world'], function(World) {
    var Renderer, canvas, context;
    canvas = World.canvas;
    context = World.context;
    Renderer = (function() {

      function Renderer(entities) {
        this.tick = __bind(this.tick, this);
        this.entities = entities;
        return this;
      }

      Renderer.prototype.tick = function(delta) {
        var alpha, entity, id, renderPosition, size, _ref;
        canvas.width = canvas.width;
        _ref = this.entities.entitiesIndex['renderer'];
        for (id in _ref) {
          entity = _ref[id];
          size = entity.components.renderer.size;
          context.save();
          renderPosition = entity.components.renderer.getPosition();
          context.fillStyle = entity.components.renderer.color;
          if (entity.components.human) {
            alpha = Math.round((1 - (entity.components.human.age / 110)) * 10) / 10;
            if (entity.components.human.sex === 'female') {
              context.fillStyle = 'rgba(255,100,255,' + alpha + ')';
            } else {
              context.fillStyle = 'rgba(100,150,200,' + alpha + ')';
            }
          }
          context.fillRect(renderPosition.x - (size / 2), renderPosition.y - (size / 2), size, size);
          context.restore();
        }
        return this;
      };

      return Renderer;

    })();
    return Renderer;
  });

}).call(this);
